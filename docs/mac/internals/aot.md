---
title: Xamarin.Mac を事前コンパイル
description: このドキュメントでは、Xamarin.Mac でコンパイルよりについて説明します。 JIT コンパイルに AOT コンパイルを比較して、AOT を有効にする方法について説明します、はハイブリッド AOT を参照してください。
ms.prod: xamarin
ms.assetid: 38B8A017-5A58-429C-A6E9-9860A1DCEF63
ms.technology: xamarin-mac
author: lobrien
ms.author: laobri
ms.date: 11/10/2017
ms.openlocfilehash: e155a394afd68d9970ee32785f6d0aeda6e2d129
ms.sourcegitcommit: 4b402d1c508fa84e4fc3171a6e43b811323948fc
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "61034205"
---
# <a name="xamarinmac-ahead-of-time-compilation"></a>Xamarin.Mac を事前コンパイル

## <a name="overview"></a>概要

事前の time (AOT) コンパイルが起動時のパフォーマンスを向上させるための強力な最適化手法です。 ただし、これも影響、ビルド時、アプリケーションのサイズ、およびプログラムの実行有効な方法でします。 トレードオフを理解するのには、コンパイルと、アプリケーションの実行を少し確認ここします。

記述されたコードなどの言語の管理C#とF#、IL と呼ばれる中間表現にコンパイルされます。 この IL は、ライブラリおよびプログラムのアセンブリに格納されているとは、比較的 compact、プロセッサ アーキテクチャ間で移植可能です。 IL では、中間の手順については、IL をプロセッサに固有のマシン語コードに変換する必要のある時点での設定のみただし、です。

この処理を実行できます 2 つの点があります。

- **ジャスト イン タイム (JIT)** – スタートアップおよび IL がメモリ内のマシン語コードにコンパイルされたアプリケーションの実行時にします。
- **Time (AOT) の先行**– IL のコンパイルしネイティブ ライブラリに書き出さされ、アプリケーション バンドル内に格納されたビルド中にします。

各オプションでは、さまざまな利点とトレードオフがあります。

- **JIT**
  - **起動時間**– 起動時に JIT コンパイルする必要があります。 約 100 ミリ秒、これは、ほとんどのアプリケーションが、大規模なアプリケーションは、この時間を大幅に詳細になる可能性が。
  - **実行**– 特定のプロセッサが使用されていると、JIT コードを最適化できます、わずかですが優れたコードを生成できます。 ほとんどのアプリケーションは、いくつかのパーセント ポイントに高速で最もです。
- **AOT**
  - **起動時間**– JIT アセンブリよりもはるかに高速ではコンパイル済みの dylib をロードします。
  - **ディスク領域**– dylib をこれらでは、大量のディスク領域をただしかかることができます。 倍増に応じて AOTed をアセンブリには、以上のアプリケーションのコード部分のサイズ。
  - **ビルド時**– AOT コンパイルが大幅に遅くなりますが、JIT し、それを使用したビルドの速度が低下します。 この遅れ範囲は最大 1 分間、またはコンパイルされたアセンブリの数とサイズに応じてさらに、秒です。
  - **難読化**– をリバース エンジニア リングのマシン語コードよりもはるかに簡単ですが、必ずしも必要でないと、IL として重要なコードを難読化することに取り除くことができます。 これには、以下のオプションについて説明します「ハイブリッド」が必要です。

## <a name="enabling-aot"></a>AOT を有効にします。

AOT オプションは、今後の更新で Mac ビルド ウィンドウに追加されます。 それまでは、AOT を有効にする必要がありますで Mac ビルド「追加の mmp 引数」フィールドを使用してコマンドライン引数を渡します。 次のようなオプションがあります。


      --aot[=VALUE]          Specify assemblies that should be AOT compiled
                               - none - No AOT (default)
                               - all - Every assembly in MonoBundle
                               - core - Xamarin.Mac, System, mscorlib
                               - sdk - Xamarin.Mac.dll and BCL assemblies
                               - |hybrid after option enables hybrid AOT which
                               allows IL stripping but is slower (only valid
                               for 'all')
                                - Individual files can be included for AOT via +
                               FileName.dll and excluded via -FileName.dll

                               Examples:
                                 --aot:all,-MyAssembly.dll
                                 --aot:core,+MyOtherAssembly.dll,-mscorlib.dll



## <a name="hybrid-aot"></a>ハイブリッド AOT

MacOS アプリケーション ランタイムの実行中には、マシン コードを使用する既定値は AOT コンパイルによって生成されたネイティブ ライブラリから読み込まれます。 ただし、JIT コンパイルが大幅により最適化された結果を生成できる領域などのコードの領域があります。 これには、使用するマネージ アセンブリの IL が必要です。 JIT コンパイルを使用して ios では、アプリケーションの制限します。これらのセクションのコードは、AOT コンパイルもです。

ハイブリッド オプションもに IL が使用できないこと実行時に想定していますの (iOS) のようにこれらのセクションを両方のコンパイルをコンパイラに指示します。 この IL が除去されることができますし、ビルドを投稿します。 前述のように、ランタイムはいくつかの場所で小さい最適化されたルーチンを使用する強制されます。

## <a name="further-considerations"></a>その他の注意事項

AOT の負の値の結果は、サイズと処理されたアセンブリの数をスケールします。 完全な[ターゲット フレームワーク](~/mac/platform/target-framework.md)の例が巨大になる基本クラス ライブラリ (BCL) 最新よりが含まれています、AOT はるかに長い時間にかかるためより大きなバンドルを生成します。 これはさらに悪化未使用のコードを除外するリンクと Full のターゲット フレームワークの非互換性をします。 最適な結果の最新かつ有効なリンクに、アプリケーションの移行を検討してください。

AOT の利点の 1 つ追加ネイティブのデバッグとプロファイリング ツール チェーンの向上の相互作用が付属します。 コードベースの大部分は、事前にコンパイルは、以降の関数名と、プロファイリングとデバッグのネイティブ クラッシュ レポート内の読み取るを容易にするシンボルがあります。 生成された JIT 関数がありませんこれらの名前。 して多くの場合、解決するのには非常に困難である名前のない 16 進数のオフセットとして表示します。
